{"ast":null,"code":"import { RESET_DATA, UPDATE_GAME } from \"../actions/actionGame\"; //生产者\n\nexport const reducerGame = function () {\n  let previousState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initData;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  let nextState = JSON.parse(JSON.stringify(previousState));\n\n  switch (action.type) {\n    case UPDATE_GAME:\n      if (action.data.info !== null) {\n        return previousState;\n      }\n\n      const newHistory = [...nextState.history, {\n        stepCount: nextState.stepCount,\n        player: nextState.stepCount % 2 === 0 ? \"X\" : \"O\",\n        position: action.data.position\n      }];\n      return nextState = {\n        history: newHistory,\n        stepCount: nextState.stepCount + 1,\n        squares: calcSquare(newHistory, nextState.stepCount + 1)\n      };\n\n    case RESET_DATA:\n      return initData;\n\n    default:\n      return previousState;\n  }\n};\nconst initData = {\n  //棋盘上的棋子信息\n  squares: new Array(9).fill(null),\n  //步数\n  stepCount: 0,\n  //历史记录\n  history: [],\n  //胜负已出\n  result: false\n};\n\nconst calcSquare = (history, stepCount) => {\n  let newSquare = new Array(9).fill(null);\n\n  for (let i = 0; i < stepCount; i++) {\n    let curHistory = history[i];\n    newSquare[curHistory.position] = curHistory.player;\n  }\n\n  return newSquare;\n};","map":{"version":3,"names":["RESET_DATA","UPDATE_GAME","reducerGame","previousState","initData","action","nextState","JSON","parse","stringify","type","data","info","newHistory","history","stepCount","player","position","squares","calcSquare","Array","fill","result","newSquare","i","curHistory"],"sources":["/Users/strawberrypompey/myspace/react/game/frontend/src/redux/reducers/reducerGame.js"],"sourcesContent":["import { RESET_DATA, UPDATE_GAME } from \"../actions/actionGame\";\n//生产者\nexport const reducerGame = (previousState = initData, action) => {\n  let nextState = JSON.parse(JSON.stringify(previousState));\n  switch (action.type) {\n    case UPDATE_GAME:\n      if (action.data.info !== null) {\n        return previousState;\n      }\n      const newHistory = [\n        ...nextState.history,\n        {\n          stepCount: nextState.stepCount,\n          player: nextState.stepCount % 2 === 0 ? \"X\" : \"O\",\n          position: action.data.position,\n        },\n      ];\n      return (nextState = {\n        history: newHistory,\n        stepCount: nextState.stepCount + 1,\n        squares: calcSquare(newHistory, nextState.stepCount + 1),\n      });\n    case RESET_DATA:\n      return initData;\n    default:\n      return previousState;\n  }\n};\nconst initData = {\n  //棋盘上的棋子信息\n  squares: new Array(9).fill(null),\n  //步数\n  stepCount: 0,\n  //历史记录\n  history: [],\n  //胜负已出\n  result: false,\n};\nconst calcSquare = (history, stepCount) => {\n  let newSquare = new Array(9).fill(null);\n  for (let i = 0; i < stepCount; i++) {\n    let curHistory = history[i];\n    newSquare[curHistory.position] = curHistory.player;\n  }\n  return newSquare;\n};\n"],"mappings":"AAAA,SAASA,UAAT,EAAqBC,WAArB,QAAwC,uBAAxC,C,CACA;;AACA,OAAO,MAAMC,WAAW,GAAG,YAAsC;EAAA,IAArCC,aAAqC,uEAArBC,QAAqB;EAAA,IAAXC,MAAW;EAC/D,IAAIC,SAAS,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeN,aAAf,CAAX,CAAhB;;EACA,QAAQE,MAAM,CAACK,IAAf;IACE,KAAKT,WAAL;MACE,IAAII,MAAM,CAACM,IAAP,CAAYC,IAAZ,KAAqB,IAAzB,EAA+B;QAC7B,OAAOT,aAAP;MACD;;MACD,MAAMU,UAAU,GAAG,CACjB,GAAGP,SAAS,CAACQ,OADI,EAEjB;QACEC,SAAS,EAAET,SAAS,CAACS,SADvB;QAEEC,MAAM,EAAEV,SAAS,CAACS,SAAV,GAAsB,CAAtB,KAA4B,CAA5B,GAAgC,GAAhC,GAAsC,GAFhD;QAGEE,QAAQ,EAAEZ,MAAM,CAACM,IAAP,CAAYM;MAHxB,CAFiB,CAAnB;MAQA,OAAQX,SAAS,GAAG;QAClBQ,OAAO,EAAED,UADS;QAElBE,SAAS,EAAET,SAAS,CAACS,SAAV,GAAsB,CAFf;QAGlBG,OAAO,EAAEC,UAAU,CAACN,UAAD,EAAaP,SAAS,CAACS,SAAV,GAAsB,CAAnC;MAHD,CAApB;;IAKF,KAAKf,UAAL;MACE,OAAOI,QAAP;;IACF;MACE,OAAOD,aAAP;EArBJ;AAuBD,CAzBM;AA0BP,MAAMC,QAAQ,GAAG;EACf;EACAc,OAAO,EAAE,IAAIE,KAAJ,CAAU,CAAV,EAAaC,IAAb,CAAkB,IAAlB,CAFM;EAGf;EACAN,SAAS,EAAE,CAJI;EAKf;EACAD,OAAO,EAAE,EANM;EAOf;EACAQ,MAAM,EAAE;AARO,CAAjB;;AAUA,MAAMH,UAAU,GAAG,CAACL,OAAD,EAAUC,SAAV,KAAwB;EACzC,IAAIQ,SAAS,GAAG,IAAIH,KAAJ,CAAU,CAAV,EAAaC,IAAb,CAAkB,IAAlB,CAAhB;;EACA,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGT,SAApB,EAA+BS,CAAC,EAAhC,EAAoC;IAClC,IAAIC,UAAU,GAAGX,OAAO,CAACU,CAAD,CAAxB;IACAD,SAAS,CAACE,UAAU,CAACR,QAAZ,CAAT,GAAiCQ,UAAU,CAACT,MAA5C;EACD;;EACD,OAAOO,SAAP;AACD,CAPD"},"metadata":{},"sourceType":"module"}