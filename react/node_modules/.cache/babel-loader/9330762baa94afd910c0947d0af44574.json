{"ast":null,"code":"var _jsxFileName = \"/Users/strawberrypompey/myspace/react/game/frontend/src/routes/Game/Game.js\";\nimport \"./style.css\";\nimport React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport Board from \"../../components/Board/Board\";\nimport PlayerInfo from \"../../components/Playerinfo/PlayerInfo\";\nimport History from \"../../components/History/History\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport store from \"../../redux/store/store\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nclass Game extends Component {\n  constructor() {\n    super(...arguments);\n    this.PropTypes = {\n      squares: PropTypes.array.isRequired,\n      stepCount: PropTypes.number.isRequired,\n      history: PropTypes.array.isRequired\n    };\n\n    this.handleClickSquare = (position, info) => {\n      if (info === null) {\n        const {\n          history\n        } = this.props;\n        const newHistory = [...history, {\n          stepCount: this.props.stepCount,\n          player: this.getCurrentPlayer(),\n          position: position\n        }];\n        this.setState({\n          history: newHistory,\n          stepCount: this.props.stepCount + 1,\n          squares: this.calcSquare(newHistory, this.props.stepCount + 1)\n        });\n      }\n    };\n  }\n\n  componentWillMount() {\n    store.subscribe(() => {\n      console.log(store.getState());\n    });\n  }\n\n  getCurrentPlayer() {\n    //根据步数，判断奇偶，确定棋手\n    return this.props.stepCount % 2 === 0 ? \"X\" : \"O\";\n  }\n\n  calcSquare(history, stepCount) {\n    const newSquare = new Array(9).fill(null);\n\n    for (let i = 0; i < stepCount; i++) {\n      let curHistory = history[i];\n      newSquare[curHistory.position] = curHistory.player;\n    }\n\n    return newSquare;\n  }\n\n  handleClickHistory(item) {\n    console.log(item);\n  }\n\n  render() {\n    const curPlayer = this.getCurrentPlayer();\n    const {\n      squares,\n      history\n    } = this.props;\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"leftPanel\",\n          children: /*#__PURE__*/_jsxDEV(Board, {\n            squares: squares,\n            def: this.handleClickSquare\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rightPanel\",\n          children: [/*#__PURE__*/_jsxDEV(PlayerInfo, {\n            curPlayer: curPlayer\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(History, {\n            history: history,\n            onClickHistory: this.handleClickHistory\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"button\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/\",\n            children: \"Exit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/again\",\n            children: \"Play again\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    squares: state.squares,\n    stepCount: state.stepCount,\n    history: state.history\n  };\n};\n\nconst mapDispatchToProps = state => {\n  return {\n    squares: state.squares,\n    stepCount: state.stepCount,\n    history: state.history\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Game);","map":{"version":3,"names":["React","Component","Link","Board","PlayerInfo","History","connect","PropTypes","store","Game","squares","array","isRequired","stepCount","number","history","handleClickSquare","position","info","props","newHistory","player","getCurrentPlayer","setState","calcSquare","componentWillMount","subscribe","console","log","getState","newSquare","Array","fill","i","curHistory","handleClickHistory","item","render","curPlayer","mapStateToProps","state","mapDispatchToProps"],"sources":["/Users/strawberrypompey/myspace/react/game/frontend/src/routes/Game/Game.js"],"sourcesContent":["import \"./style.css\";\nimport React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport Board from \"../../components/Board/Board\";\nimport PlayerInfo from \"../../components/Playerinfo/PlayerInfo\";\nimport History from \"../../components/History/History\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport store from \"../../redux/store/store\";\n\nclass Game extends Component {\n  PropTypes = {\n    squares: PropTypes.array.isRequired,\n    stepCount: PropTypes.number.isRequired,\n    history: PropTypes.array.isRequired,\n  };\n  componentWillMount() {\n    store.subscribe(() => {\n      console.log(store.getState());\n    });\n  }\n  getCurrentPlayer() {\n    //根据步数，判断奇偶，确定棋手\n    return this.props.stepCount % 2 === 0 ? \"X\" : \"O\";\n  }\n\n  handleClickSquare = (position, info) => {\n    if (info === null) {\n      const { history } = this.props;\n      const newHistory = [\n        ...history,\n        {\n          stepCount: this.props.stepCount,\n          player: this.getCurrentPlayer(),\n          position: position,\n        },\n      ];\n\n      this.setState({\n        history: newHistory,\n        stepCount: this.props.stepCount + 1,\n        squares: this.calcSquare(newHistory, this.props.stepCount + 1),\n      });\n    }\n  };\n\n  calcSquare(history, stepCount) {\n    const newSquare = new Array(9).fill(null);\n    for (let i = 0; i < stepCount; i++) {\n      let curHistory = history[i];\n      newSquare[curHistory.position] = curHistory.player;\n    }\n    return newSquare;\n  }\n\n  handleClickHistory(item) {\n    console.log(item);\n  }\n\n  render() {\n    const curPlayer = this.getCurrentPlayer();\n    const { squares, history } = this.props;\n    return (\n      <>\n        <div className=\"App\">\n          <div className=\"leftPanel\">\n            <Board squares={squares} def={this.handleClickSquare} />\n          </div>\n          <div className=\"rightPanel\">\n            <PlayerInfo curPlayer={curPlayer} />\n            <History\n              history={history}\n              onClickHistory={this.handleClickHistory}\n            />\n          </div>\n        </div>\n        <div className=\"button\">\n          <button>\n            <Link to=\"/\">Exit</Link>\n          </button>\n          <button>\n            <Link to=\"/again\">Play again</Link>\n          </button>\n        </div>\n      </>\n    );\n  }\n}\nconst mapStateToProps = (state) => {\n  return {\n    squares: state.squares,\n    stepCount: state.stepCount,\n    history: state.history,\n  };\n};\n\nconst mapDispatchToProps = (state) => {\n  return {\n    squares: state.squares,\n    stepCount: state.stepCount,\n    history: state.history,\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Game);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}